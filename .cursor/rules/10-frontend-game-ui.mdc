---
applyTo: "frontend/**/*.{ts,tsx,css,html}"
description: "React/Vite 프론트엔드(UI/UX) 규칙: 채팅 UI 금지, CRT 테마, 핫스팟/드래그, i18n, 에이전트 콘솔"
priority: high
tags: [frontend, react, ui, ux, dnd, i18n, crt]
---

# 프론트엔드(UI/UX) 세부 지침

## 적용 대상

- `frontend/**/*.{ts,tsx,css,html}`

## Core 규칙 연계 (SSOT)

- 이 문서는 `.cursor/rules/00-core-critical.mdc`의 아래 규칙을 **프론트엔드 관점에서 구체화**합니다:
  - RULE-002 (채팅 UI 금지 / 게임 UI 고정)
  - RULE-006 (ko/en i18n 정책)
  - RULE-008 (프롬프트/내부 추론 노출 금지 + 단계/배지/복구 가시화)
  - RULE-009 (핫스팟 좌표 규약)
- 충돌 시: `00-core-critical.mdc`의 RULE이 우선합니다.

## 규칙

### 규칙 1: 채팅 UI를 만들지 말고 “게임 화면”을 고정한다

**설명**: 채팅 버블/메신저 레이아웃은 금지입니다. UI는 PRD의 “데모 표면 핵심” 구성요소가 항상 보이게 설계합니다.

**올바른 예시**:

```text
- Header: 타이틀/언어/테마/재화 HUD/연결 상태
- Center: Scene Canvas(이미지 + 핫스팟)
- Side: Inventory / Quest / Rule Board / Agent Console(Plan·Queue·Badges)
- Footer: Action Deck(카드) + 입력
```

**잘못된 예시**:

```text
- 좌/우 채팅 버블 + 하단 입력창
- 선택지 버튼만 있는 챗봇 UI
```

**이유**: “Prompt-only wrapper 오해 방지”가 PRD의 핵심 제출 요건입니다. (참조: `vibe/prd.md`)

---

### 규칙 2: CRT 테마는 CSS 변수로만 제어한다 (임의 색상/프레임워크 도입 금지)

**설명**: 테마는 `data-theme="dark|light"` + CSS 변수로 제어합니다. 컴포넌트별 임의 색상/인라인 스타일/유틸 CSS 프레임워크(Tailwind 등) 도입은 금지합니다.

**올바른 예시**:

```css
:root { --bg-color:#0d0d0d; --text-color:#33ff00; --accent-color:#ff00ff; }
[data-theme="light"] { --bg-color:#f5f7f5; --text-color:#0b3d0b; }
```

**잘못된 예시**:

```text
- 컴포넌트마다 #33ff00 같은 하드코딩
- Tailwind로 임의 클래스 난립
```

**이유**: “CRT 정체성 + 가독성”을 유지하려면 단일 디자인 토큰(변수)로 통제해야 합니다. (참조: `vibe/ref/frontend-style-guide.md`)

---

### 규칙 3: 핫스팟 좌표는 0~1000 정규화 규약을 그대로 사용한다

**설명**: 오브젝트/핫스팟 bbox는 `[ymin, xmin, ymax, xmax]`(0~1000) 입니다. 화면 리사이즈/비율 변경에도 동일 규약을 유지해야 합니다.

**올바른 예시**:

```ts
export function denormBox2d(
  box: [number, number, number, number],
  canvasW: number,
  canvasH: number,
) {
  const [ymin, xmin, ymax, xmax] = box;
  return {
    left: (xmin / 1000) * canvasW,
    top: (ymin / 1000) * canvasH,
    width: ((xmax - xmin) / 1000) * canvasW,
    height: ((ymax - ymin) / 1000) * canvasH,
  };
}
```

**잘못된 예시**:

```text
- [x, y, w, h] 로컬 픽셀 좌표로 저장/전송
- bbox 순서를 x/y 기반으로 바꿈
```

**이유**: 이미지 이해 bbox와의 호환/재사용을 위해 좌표 규약이 고정되어야 합니다. (참조: `vibe/prd.md`, `vibe/tech-stack.md`)

---

### 규칙 4: DnD는 dnd-kit 기반으로 접근성/예측 가능성을 보장한다

**설명**: Inventory → Scene Object 드롭을 핵심 인터랙션으로 제공해야 합니다.

**올바른 예시**:

```text
- 드래그 시작/드롭 대상 hover 상태를 시각적으로 표시
- 키보드 접근(가능한 범위)과 포커스 이동 고려
- 실패(드롭 불가) 시 이유를 즉시 안내
```

**잘못된 예시**:

```text
- HTML5 drag만 대충 붙여서 모바일/접근성 깨짐
- 드롭 실패 시 아무 피드백 없음
```

**이유**: “게임 동작”을 체감시키는 데모 핵심이 DnD이기 때문입니다. (참조: `vibe/prd.md`, `vibe/tech-stack.md`)

---

### 규칙 5: Action Deck에는 비용/위험/대안을 반드시 표기한다

**설명**: 각 카드(3~6장)는 `Signal/Shard` **예상 비용**과 위험/보상 힌트를 포함해야 합니다.

**올바른 예시**:

```text
카드: "스캐너로 단서 분석" (예상 -12 Signal, 위험: 낮음, 보상: 단서+2)
잔액 부족 시: "텍스트 분석으로 대체(저비용)" 카드 제공
```

**잘못된 예시**:

```text
- 비용 표기 없이 실행
- 부족해도 클릭 가능(실행 후 오류)
```

**이유**: 비용 리스크를 “전략”으로 전환하는 UX 요구사항입니다. (참조: `vibe/prd.md`)

---

### 규칙 6: i18n은 i18next로 구현하고, ko/en 혼합 출력을 방지한다

**설명**: 언어는 즉시 토글되며, 내러티브/라벨/시스템 메시지는 동일 언어로 고정합니다.

**올바른 예시**:

```text
- 언어 토글: ko-KR ↔ en-US
- UI 문자열: i18n 키 기반
- 서버 TurnInput.language를 항상 전송
```

**잘못된 예시**:

```text
- UI 문자열을 한국어로 하드코딩
- 내러티브는 ko인데 버튼은 en
```

**이유**: PRD의 2개 국어 정책 및 “혼합 출력 방지” 요구를 충족해야 합니다. (참조: `vibe/prd.md`, `vibe/tech-stack.md`)

---

### 규칙 7: 에이전트 콘솔은 “단계/배지/복구”만 보여주고 프롬프트는 숨긴다

**설명**: 에이전트형 시스템을 증명하되, 프롬프트/내부 추론은 노출하지 않습니다.

**올바른 예시**:

```text
- Queue: Parse → Validate → Plan → Resolve → Render → Verify → Commit
- Badges: Schema OK / Economy OK / Safety OK / Consistency OK
- Auto-repair #n 결과(성공/실패)만 표시
```

**잘못된 예시**:

```text
- 프롬프트 원문/시스템 메시지를 개발자 콘솔에 그대로 출력
- 내부 추론을 UI로 노출
```

**이유**: PRD 6.8/10.2의 “프롬프트 노출 금지”를 준수해야 합니다. (참조: `vibe/prd.md`)

## 예외 처리

- 극초기 프로토타입이라도 “채팅 버블 UI”는 금지입니다(예외 없음).
- 디자인 토큰을 추가해야 한다면 `vibe/ref/frontend-style-guide.md`에 근거를 남기고 CSS 변수로만 확장합니다.

## 체크리스트

- [ ] 채팅 UI처럼 보이지 않는가?
- [ ] CRT 테마가 CSS 변수 기반인가?
- [ ] 핫스팟 bbox 규약(0~1000, ymin/xmin/ymax/xmax)을 지키는가?
- [ ] Action Deck에 비용/대안이 있는가?
- [ ] Inventory DnD가 핵심 동작으로 동작하는가?
- [ ] Agent Console이 단계/배지/복구를 보여주는가(프롬프트 노출 없음)?
- [ ] ko/en 토글 시 혼합 출력이 없는가?

## 관련 지침

- `.cursor/rules/00-core-critical.mdc`
- `vibe/prd.md`
- `vibe/ref/frontend-style-guide.md`

