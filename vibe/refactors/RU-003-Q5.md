# [ID: RU-003-Q5] 하드코딩/DEV 목 데이터 격리: i18n 혼합 출력 방지 + 데모 프로필 경계 확보

## 📌 기본 정보

| 항목               | 내용                |
| ------------------ | ------------------- |
| **ID**             | RU-003-Q5           |
| **심각도**         | High                |
| **카테고리**       | 하드코딩 (Hard-coded Values) |
| **영향 범위**      | `frontend/src/App.tsx`, (권장) `frontend/src/locales/*/translation.json`, (신규 권장) `frontend/src/demo/demoFixtures.ts` 또는 `frontend/src/demo/demoProfile.ts` |
| **예상 작업 시간** | 30~60분             |

---

## 🔍 문제점 상세 분석

### 현재 상황

현재 `frontend/src/App.tsx`에는 데모를 위한 임시 데이터가 “빠르게 동작하는 형태”로 인라인 하드코딩되어 있습니다.

- 데모용 인벤토리 초기화(`useEffect`)가 **한국어 문자열**을 그대로 포함 (`App.tsx` 274~285)
- 데모용 씬 오브젝트(`sceneObjects`)도 **한국어 라벨/힌트**를 그대로 포함 (`App.tsx` 303~318)

또한 TurnInput에 포함되는 `client.theme`가 항상 `'dark'`로 고정되어 있습니다(`App.tsx` 401~406).

### 문제가 되는 이유

1. **RULE-006(ko/en 혼합 출력 금지) 위반 위험**  
   언어를 `en-US`로 실행해도, 인벤토리/오브젝트 라벨이 한국어로 남아 “UI/내러티브 혼합 출력”이 발생할 수 있습니다.  
   (예: `t('scene.hotspot.drop_action')`의 템플릿은 영어인데 `itemName/targetLabel`은 한국어로 들어가는 케이스)
2. **경계 오염(데모 데이터가 프로덕션 코드에 고착)**  
   DemoProfile/SaveGame이 들어오면, “초기 상태의 출처”가 더 늘어나는데 현재는 App 내부에 섞여 있어 이관 비용이 커집니다.
3. **SSOT 부재**  
   “데모 초기 상태(재화/아이템/오브젝트)”는 PRD의 데모 프로필 요구사항(6.9)과 직접 맞물리므로, 별도 모듈/정책으로 고정하는 편이 안전합니다.

### 영향받는 코드 위치

- `frontend/src/App.tsx`
  - 데모 인벤토리 하드코딩: 274~285
  - 데모 오브젝트 하드코딩: 303~318
  - TurnInput 테마 하드코딩: 401~406

### 현재 코드 예시

```ts
// frontend/src/App.tsx (DEV 목 인벤토리)
addInventoryItems([
  { id: 'keycard-alpha', name: '키카드 A', icon: '🔑', quantity: 1 },
  { id: 'medkit', name: '응급 키트', icon: '🩹', quantity: 2 },
  // ...
]);
```

---

## 💡 개선 방안

### 제안하는 접근법

DEV 목 데이터는 App에서 제거하고, **데모 전용 모듈로 격리**합니다. 또한 표시 문자열은 i18n 키 기반으로 생성하여 **언어 혼합을 구조적으로 차단**합니다.

권장 목표:

- “ID/아이콘/수량”처럼 언어 중립적인 값만 코드에 두고
- “표시 이름/설명”은 i18n 키로 렌더링(또는 서버 TurnOutput에서 제공)하도록 경계 고정

### 구체적 실행 단계

#### Step 1: 데모 초기 상태를 `frontend/src/demo/demoFixtures.ts`로 이동

예시(개념):

```ts
// frontend/src/demo/demoFixtures.ts
export const DEMO_INVENTORY_IDS = [
  { id: 'keycard-alpha', icon: '🔑', quantity: 1 },
  { id: 'medkit', icon: '🩹', quantity: 2 },
] as const;

export const DEMO_SCENE_OBJECTS = [
  { id: 'demo-terminal', labelKey: 'demo.scene.terminal.label', hintKey: 'demo.scene.terminal.hint', box_2d: { ymin: 300, xmin: 100, ymax: 600, xmax: 400 } },
] as const;
```

#### Step 2: 표시 라벨은 i18n 키로 생성(혼합 출력 방지)

- 인벤토리 표시 시: `t('demo.items.keycard-alpha.name')` 같은 키로 name을 생성
- 씬 오브젝트 표시 시: `labelKey/hintKey`를 통해 `t(...)`로 렌더링

> 핵심: “표시 문자열을 코드 하드코딩하지 않는다”는 규칙을 데모 데이터에도 적용합니다.

#### Step 3: DEV 목 주입은 `import.meta.env.DEV`로 가드

App에서 데모 주입이 필요하다면, 최소한 아래 조건을 고정합니다.

- DEV에서만 주입
- store/월드 초기화 경로가 1곳(예: worldStore `initDemoWorld`)으로 모이도록 정리

#### Step 4: TurnInput.client.theme 하드코딩 제거(가능한 범위)

현재는 `'dark'` 고정(`App.tsx` 404)인데,

- (권장) 테마 상태가 존재한다면 그것을 전송
- (현 구조 유지 시) 최소한 “DOM에서 현재 theme 읽기”로 바꿔 고정값을 제거

---

## 📈 기대 효과

### 즉각적 효과

- ✅ ko/en 혼합 출력(하드 룰 위반) 가능성 감소
- ✅ 데모 프로필/세이브/초기화 경계가 명확해져 이후 확장이 쉬워짐

### 장기적 효과

- 🎯 PRD 6.9 “데모 프로필” 구현 시, 초기 상태 출처를 자연스럽게 확장 가능

---

## ⚠️ 주의사항 및 고려사항

1. DEV 목 데이터는 “임시 편의”가 아니라, 데모의 첫 인상을 결정하므로 i18n/규칙을 동일하게 적용해야 합니다.
2. 데모 데이터가 서버 TurnOutput로 대체되는 시점이 오면, 이 모듈은 제거/비활성화 가능하도록 설계합니다.

---

## 🧪 검증 방법 (수동 검증 중심)

1. 언어를 `en-US`로 실행했을 때 Inventory/Hotspot 라벨이 영어로만 표시되는지 확인
2. 드롭 텍스트가 템플릿/라벨 모두 동일 언어로 구성되는지 확인
3. DEV가 아닌 환경에서 데모 목 데이터가 주입되지 않는지 확인(빈 인벤토리/빈 오브젝트로 시작 등)

---

## 🔧 실행 가이드

1. `demoFixtures.ts`(또는 demoProfile 모듈) 생성
2. App에서 하드코딩 배열 제거 → demo 모듈 import + DEV 가드로 주입
3. RU-003-S3 수동 시나리오에서 언어 토글/드롭 텍스트 혼합 여부 확인

---

## 📚 참고 자료

- `vibe/prd.md` 3장(언어 정책), 6.9(데모 프로필), RULE-006
- `vibe/unit-plans/RU-003[Mvp].md` 주의사항(i18n 정책 준수)
- `frontend/src/App.tsx` (데모 목 데이터 위치)

---

## 🏷️ 태그

`#refactoring` `#hardcoded` `#high` `#i18n` `#demo-profile`

