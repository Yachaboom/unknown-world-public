# U-011[Mvp] Inventory 패널(DnD) 기본 실행 가이드

## 1. 개요

인벤토리 패널에 `dnd-kit` 기반의 드래그 가능한 아이템을 구현했습니다. 아이템을 드래그하면 시각적 피드백(반투명 원본 + 오버레이)이 제공되며, 실제 드롭 액션 실행은 U-012에서 구현됩니다.

**예상 소요 시간**: 5분

**의존성**:
- 의존 유닛: U-004[Mvp] (고정 HUD 레이아웃), U-006[Mvp] (TurnInput/TurnOutput 스키마)
- 선행 완료 필요: 없음 (스키마 연동은 형식 참조만)

---

## 2. 빠른 시작 (Quick Start)

### 2.1 환경 준비

```bash
# 프로젝트 루트에서 의존성 설치
cd frontend
pnpm install
```

### 2.2 의존 유닛 확인

```bash
# U-004 레이아웃 스켈레톤 존재 확인
ls src/components/Panel.tsx
ls src/style.css

# U-006 스키마 존재 확인
ls src/schemas/turn.ts
```

### 2.3 즉시 실행

```bash
# 개발 서버 시작
pnpm run dev
```

### 2.4 첫 화면/결과 확인

- 브라우저에서 `http://localhost:8001` 접속
- 좌측 사이드바 상단에 **Inventory** 패널 노출
- 4개의 데모 아이템이 2열 레이아웃으로 표시:
  - 🔑 키카드 A (x2)
  - 🩹 응급 키트 (x4)
  - 🔦 손전등 (x2)
  - 💾 데이터칩 (x6)

---

## 3. 핵심 기능 시나리오

### 시나리오 A: 인벤토리 아이템 렌더링

**목적**: 인벤토리 패널에 아이템이 올바르게 렌더링되는지 확인

**실행**:
1. 브라우저에서 `http://localhost:8001` 접속
2. 좌측 사이드바 상단의 Inventory 패널 확인

**기대 결과**:
- 4개 아이템이 2열 그리드로 배치
- 각 아이템에 이모지 아이콘, 라벨(대문자), 수량 표시
- CRT 테마 스타일(녹색 테두리, 어두운 배경) 적용

**확인 포인트**:
- ✅ Inventory 패널 타이틀 표시
- ✅ 아이템 4개 정상 렌더링
- ✅ 아이템 hover 시 녹색 글로우 효과

---

### 시나리오 B: 드래그 시작 및 시각적 피드백

**목적**: 아이템 드래그 시 오버레이와 피드백 확인

**실행**:
1. 마우스로 "키카드 A" 아이템을 클릭
2. 5px 이상 드래그(활성화 거리)
3. 드래그 상태에서 화면 이동

**기대 결과**:
```
[원본 아이템] → 반투명(opacity: 0.5) + 녹색 테두리 강조
[드래그 오버레이] → 커서를 따라다니는 CRT 스타일 박스
  - 어두운 녹색 배경
  - 밝은 녹색 테두리
  - 글로우 효과
  - 아이콘 + 라벨 표시
```

**확인 포인트**:
- ✅ 5px 드래그 후 드래그 모드 활성화
- ✅ 원본 아이템 반투명 처리
- ✅ DragOverlay가 커서를 따라 이동
- ✅ 오버레이에 아이템 정보 표시

---

### 시나리오 C: 드래그 종료

**목적**: 드래그 취소/종료 시 원래 상태로 복귀 확인

**실행**:
1. 아이템을 드래그 시작
2. 빈 공간에서 마우스 버튼 놓기
3. 인벤토리 패널 상태 확인

**기대 결과**:
- 드래그 오버레이 사라짐
- 원본 아이템 opacity 복귀 (1.0)
- 아이템 순서/수량 변화 없음

**확인 포인트**:
- ✅ 오버레이 정상 소멸
- ✅ 아이템 상태 복귀
- ✅ 콘솔에 에러 없음

---

### 시나리오 D: 키보드 접근성

**목적**: 키보드로 드래그 기능 접근 가능 여부 확인

**실행**:
1. Tab 키로 인벤토리 아이템으로 포커스 이동
2. Space 또는 Enter 키로 드래그 시작
3. 화살표 키로 이동 (dnd-kit 기본 지원)
4. Space 또는 Enter로 드롭

**기대 결과**:
- Tab 순서에 아이템 포함
- 포커스 시 녹색 테두리 강조
- Space/Enter로 드래그 활성화

**확인 포인트**:
- ✅ 키보드 포커스 가능
- ✅ aria-label로 아이템 정보 읽기 가능
- ✅ 스크린 리더 호환

---

## 4. 실행 결과 확인

### 4.1 로그 확인

- 브라우저 DevTools Console 열기 (F12)
- 드래그 시작/종료 시 에러 없음 확인
- React 경고 메시지 없음 확인

### 4.2 생성/수정 파일

| 파일 | 유형 | 설명 |
|------|------|------|
| `src/stores/inventoryStore.ts` | 신규 | Zustand 인벤토리 상태 관리 |
| `src/components/InventoryPanel.tsx` | 신규 | 드래그 가능 인벤토리 UI |
| `src/App.tsx` | 수정 | DndContext 최상단 배치, InventoryPanel 연결 |
| `src/style.css` | 수정 | 인벤토리/드래그 스타일 추가 |
| `src/locales/ko-KR/translation.json` | 수정 | 인벤토리 i18n 키 추가 |
| `src/locales/en-US/translation.json` | 수정 | 인벤토리 i18n 키 추가 |

### 4.3 성공/실패 판단 기준

**성공**:
- ✅ Inventory 패널이 좌측 사이드바에 렌더링
- ✅ 4개 데모 아이템 2열 배치
- ✅ 드래그 시 DragOverlay 표시
- ✅ 드래그 종료 시 원상 복귀
- ✅ 린트/타입체크 통과

**실패 시 확인**:
- ❌ 아이템 미표시 → `useInventoryStore` 초기화 확인, `App.tsx`의 mock 데이터
- ❌ 드래그 불가 → `@dnd-kit/core`, `@dnd-kit/utilities` 설치 확인
- ❌ 오버레이 미표시 → `DndContext`가 `game-container`를 감싸는지 확인

---

## 5. 문제 해결 (Troubleshooting)

### 5.1 일반적인 오류

**오류**: `Cannot find module '@dnd-kit/utilities'`
- **원인**: 패키지 미설치
- **해결**:
  ```bash
  pnpm add @dnd-kit/utilities
  ```

**오류**: `드래그가 시작되지 않음`
- **원인**: PointerSensor activationConstraint (5px)
- **해결**: 5px 이상 드래그해야 활성화됨 (의도된 동작)

**오류**: `DragOverlay가 표시되지 않음`
- **원인**: activeId 상태 미설정
- **해결**: `App.tsx`의 `handleDragStart`에서 `setActiveId` 호출 확인

### 5.2 환경별 주의사항

- **Windows**: 터치스크린에서 PointerSensor 동작 확인 필요
- **macOS/Linux**: 트랙패드 제스처와 충돌 가능성 (드래그 거리 조정 고려)

---

## 6. 다음 단계

- **U-012**: SceneCanvas 핫스팟에 드롭 영역 구현 (아이템 사용 액션 연결)
- **U-013**: TurnOutput에서 실제 인벤토리 데이터 연동
