# U-117[Mvp] 인벤토리 드래그 영역 Row 확장 + 스캐너 온보딩 팝업 제거 실행 가이드

## 1. 개요

인벤토리 아이템의 **드래그 시작 영역을 Row 전체**로 확장하여 드래그 조작의 편의성을 높이고, **드래그 중 고스트(미리보기) 이미지는 아이콘만** 표시하도록 개선했습니다. 또한 화면 우하단의 **온보딩 가이드 팝업을 제거**하고, hover 힌트 시스템(첫 N회 노출 후 숨김)만 유지합니다.

**예상 소요 시간**: 5분

**의존성**:

- 의존 유닛: U-088[Mvp] (인벤토리 Row 형태 레이아웃), U-011[Mvp] (Inventory DnD 기본 구현)
- 선행 완료 필요: 기본 의존성 설치 (pnpm install)

---

## 2. 빠른 시작 (Quick Start)

### 2.1 환경 준비

```bash
cd frontend
pnpm install
```

### 2.2 즉시 실행

```bash
cd frontend
pnpm run dev --port 8001
```

### 2.3 첫 화면/결과 확인

- 브라우저에서 `http://localhost:8001` 접속
- 프로필 선택 화면에서 **"탐험가"** 프로필 선택 (아이템 4개 보유)
- 좌측 사이드바 **INVENTORY (4)** 패널 확인
- 성공 지표:
  - Row 전체 영역에서 커서가 `grab` 모양으로 표시됨
  - 온보딩 가이드 팝업(화면 우하단)이 **표시되지 않음**

---

## 3. 핵심 기능 시나리오

### 시나리오 A: Row 전체에서 드래그 시작 가능

**목적**: Row의 아이콘뿐 아니라 이름/수량 영역에서도 드래그가 시작되는지 검증

**실행**:

1. "탐험가" 프로필 선택하여 게임 시작
2. 인벤토리에서 **아이템 이름** 영역에 마우스를 올림
3. 5px 이상 마우스를 이동하면서 드래그 시작
4. 드래그 상태에서 화면 이동

**기대 결과**:

- Row 전체 영역(아이콘 + 이름 + 수량)에서 드래그 시작 가능
- 커서: Row 위에서 `grab`, 드래그 중 `grabbing`
- 5px 미만 이동 시 드래그 시작되지 않음 (클릭으로 처리)

**확인 포인트**:

- ✅ 아이콘 영역에서 드래그 시작 가능
- ✅ 이름 영역에서 드래그 시작 가능
- ✅ 수량 영역에서 드래그 시작 가능
- ✅ 5px 미만 이동 시 드래그 아닌 클릭(선택) 처리

---

### 시나리오 B: 드래그 중 고스트(DragOverlay) 아이콘만 표시

**목적**: 드래그 중 오버레이가 Row 전체가 아닌 **아이콘만** 표시하는지 검증

**실행**:

1. 인벤토리에서 아이템 Row를 드래그 시작
2. 드래그 중 오버레이 확인

**기대 결과**:

- 드래그 오버레이에 **아이콘만** 표시 (40px 컴팩트 박스)
- 녹색 글로우 효과가 아이콘에 적용됨
- Row 전체가 오버레이에 표시되지 않음

**확인 포인트**:

- ✅ 오버레이에 아이콘만 표시 (이름/수량 미포함)
- ✅ 오버레이 크기 약 40x40px

---

### 시나리오 C: 드래그 중 원래 Row 시각 피드백

**목적**: 드래그 중 원래 Row가 반투명 처리되는지 검증

**실행**:

1. 인벤토리에서 아이템을 드래그
2. 원래 Row 상태 확인

**기대 결과**:

- 원래 Row: opacity 0.4 (반투명)
- 구분선이 dashed 스타일로 변경됨
- 커서가 grabbing으로 변경됨

**확인 포인트**:

- ✅ 반투명 처리됨 (opacity: 0.4)
- ✅ border-bottom-style: dashed
- ✅ 드래그 종료 후 원래 상태로 복귀

---

### 시나리오 D: 클릭(선택)과 드래그 구분

**목적**: 5px activationConstraint로 클릭과 드래그가 올바르게 구분되는지 검증

**실행**:

1. 인벤토리에서 아이템 Row를 **클릭** (마우스 이동 없이)
2. 다른 아이템 Row를 **클래그** (5px 이상 이동)

**기대 결과**:

| 동작 | 결과 |
|------|------|
| Row 클릭 (5px 미만 이동) | 아이템 선택 (좌측 마젠타 강조선) |
| Row 드래그 (5px 이상 이동) | 드래그 시작 (DragOverlay 표시) |

**확인 포인트**:

- ✅ 클릭 시 선택 상태 전환 (토글)
- ✅ 드래그 시 선택 아닌 드래그 동작
- ✅ 의도치 않은 드래그 시작 없음

---

### 시나리오 E: 핫스팟 드롭 동작 유지

**목적**: Row 전체 드래그 후 핫스팟 드롭이 정상 동작하는지 검증

**전제 조건**:

- 백엔드 서버 실행 중 (또는 mock 모드)
- Scene Canvas에 핫스팟이 존재하는 상태

**실행**:

1. 인벤토리 아이템을 Row 어디서든 드래그 시작
2. Scene Canvas의 핫스팟(빛나는 영역)으로 이동
3. 핫스팟 위에서 드롭

**기대 결과**:

- 핫스팟 위: 기존 하이라이트 효과 유지
- 드롭 시 턴 실행 요청 (액션 로그에 기록)
- 유효하지 않은 영역에 드롭 시 "사용할 수 없습니다" 메시지

**확인 포인트**:

- ✅ 핫스팟 드롭 이벤트 정상 처리
- ✅ 빈 공간 드롭 시 에러 없이 복귀
- ✅ DnD 인터랙션 테스트 통과 확인

---

### 시나리오 F: 온보딩 가이드 팝업 제거 확인

**목적**: 화면 우하단 온보딩 가이드 팝업이 완전히 제거되었는지 검증

**실행**:

1. 프로필 선택 후 게임 시작
2. 화면 우하단 확인
3. localStorage의 `unknown-world-onboarding` 키 확인 (DevTools > Application > Local Storage)

**기대 결과**:

- 온보딩 가이드 팝업 **미표시**
- localStorage에 `onboardingComplete` 키 **미저장** (hint 카운트만 저장)
- ESC/Enter 키 입력 시 온보딩 관련 동작 없음

**확인 포인트**:

- ✅ 온보딩 가이드 팝업이 화면에 표시되지 않음
- ✅ DOM에 `.onboarding-guide` 요소 미존재
- ✅ 콘솔에 OnboardingGuide 관련 에러 없음

---

### 시나리오 G: Hover 힌트 유지 확인

**목적**: 아이템/핫스팟 hover 힌트가 여전히 동작하는지 검증

**실행**:

1. 인벤토리 아이템 위에 마우스를 올림 (hover)
2. Scene Canvas 핫스팟 위에 마우스를 올림 (hover)

**기대 결과**:

- 아이템 hover: "드래그하여 사용" 힌트 표시 (첫 3회만)
- 핫스팟 hover: "클릭하여 조사" 힌트 표시 (첫 3회만)
- 3회 초과 후 힌트 자동 숨김

**확인 포인트**:

- ✅ InteractionHint 컴포넌트 정상 동작
- ✅ 힌트 카운트가 localStorage에 저장됨
- ✅ 3회 후 힌트 자동 숨김

---

## 4. 실행 결과 확인

### 4.1 로그 확인

- 위치: 브라우저 DevTools Console (F12)
- 주요 확인 사항:
  - `[ERROR]` 레벨 메시지 없음
  - React 경고 메시지 없음
  - `OnboardingGuide` 관련 에러 없음

### 4.2 성공/실패 판단 기준

**성공**:

- ✅ Row 전체에서 드래그 시작 가능
- ✅ 고스트 오버레이에 아이콘만 표시
- ✅ 드래그 중 Row 반투명(0.4) + dashed border
- ✅ 클릭/드래그 구분 정상 (5px threshold)
- ✅ 핫스팟 드롭 동작 유지
- ✅ 온보딩 가이드 팝업 미표시
- ✅ hover 힌트 정상 동작
- ✅ Tab 포커스 및 접근성 유지

**실패 시 확인**:

- ❌ 드래그가 안 됨 → `{...listeners}` 가 `.inventory-item` div에 적용되었는지 확인
- ❌ 클릭이 드래그로 처리됨 → `App.tsx`의 `PointerSensor.distance: 5` 확인
- ❌ 온보딩 팝업이 나타남 → `App.tsx`에서 `<OnboardingGuide />` 렌더링이 제거되었는지 확인
- ❌ 힌트가 안 나옴 → `onboardingStore.ts`에서 hint 관련 코드가 유지되었는지 확인

---

## 5. 문제 해결 (Troubleshooting)

### 5.1 일반적인 오류

**오류**: Row 전체에서 드래그가 시작되지 않음

- **원인**: `{...listeners}` 가 아이콘 div에 남아있음
- **해결**: `InventoryPanel.tsx`에서 `{...attributes}` 와 `{...listeners}` 가 `.inventory-item` div에 적용되었는지 확인

**오류**: 클릭 시 의도치 않은 드래그 시작

- **원인**: activationConstraint distance 값이 너무 낮음
- **해결**: `App.tsx`의 `PointerSensor` 설정에서 `distance: 5` 확인

**오류**: 온보딩 가이드가 여전히 표시됨

- **원인**: 캐시된 JS 파일 사용
- **해결**: 브라우저 캐시 삭제 후 새로고침 (Ctrl+Shift+R)

### 5.2 환경별 주의사항

- **Windows**: 경로 구분자 주의 (D:\Dev\...)
- **macOS/Linux**: 특이사항 없음
- **터치 환경**: distance 5px는 터치에서 약간 민감할 수 있음 → 필요 시 delay 옵션 추가 고려

---

## 6. 다음 단계

- **CP-MVP-03**: Row 전체 드래그 + 아이콘 고스트 데모 시나리오 검증
- **U-087**: 입력 잠금 시 드래그 비활성화 통합 확인
