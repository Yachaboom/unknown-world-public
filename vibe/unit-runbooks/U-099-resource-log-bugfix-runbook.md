# U-099[Mvp] 거래 장부(Resource Log) 버그 수정 실행 가이드

## 1. 개요

거래 장부(Resource Log / Economy HUD 내 ledger 목록)의 두 가지 버그를 수정했습니다:
1. **i18n 언어 혼합 출력**: 영문(en-US) 모드에서도 거래 장부 항목이 한국어로 표시되던 문제 → `i18n.t()` 기반 사유 텍스트로 전환
2. **하단 여백 과다**: 거래 장부 내용이 적을 때 CSS `flex: 1`로 인해 빈 공간이 과도하게 남던 문제 → `flex: none`으로 변경

**예상 소요 시간**: 5분

**의존성**:
- 의존 유닛: U-042[Mvp] (용어/카피 정리), U-044[Mvp] (세션 언어 SSOT)
- 선행 완료 필요: 없음 (의존 유닛 이미 완료)

---

## 2. 빠른 시작 (Quick Start)

### 2.1 환경 준비

```bash
pnpm install
```

### 2.2 즉시 실행

프론트엔드와 백엔드를 각각 실행합니다:

```bash
# 프론트엔드 (포트 8001)
pnpm run dev:front
```

```bash
# 백엔드 (포트 8011)
pnpm run dev:back
```

### 2.3 첫 화면 확인

- http://localhost:8001 접속
- 프로필 선택 화면이 표시됨
- 성공 지표: 언어 전환 버튼이 좌상단에 보임

---

## 3. 핵심 기능 시나리오

### 시나리오 A: en-US 모드 거래 장부 i18n 확인

**목적**: 영문 모드에서 거래 장부 항목이 영어로만 표시되는지 검증

**실행**:
1. http://localhost:8001 접속
2. 좌상단 언어 버튼 클릭 → "English" 모드로 전환
3. 아무 프로필(예: Narrator) 선택
4. 하단 액션 카드(예: "EXPLORE") 클릭 → 턴 진행
5. 우측 "ECONOMY STATUS" 패널의 "RESOURCE LOG" 섹션 확인

**기대 결과**:
- 거래 장부 제목: "RESOURCE LOG"
- 항목 사유: "Turn Cost" (영어)
- 한국어 텍스트가 섞여 나오지 않음

**확인 포인트**:
- ✅ "RESOURCE LOG" 제목이 영어로 표시됨
- ✅ "T1 Turn Cost -N F" 형태로 영어 사유 표시
- ✅ 한국어 텍스트가 없음

---

### 시나리오 B: ko-KR 모드 거래 장부 i18n 확인

**목적**: 한국어 모드에서 거래 장부 항목이 한국어로만 표시되는지 검증

**실행**:
1. 좌상단 언어 버튼 클릭 → "한국어" 모드로 전환
2. 아무 프로필(예: 서사꾼) 선택
3. 하단 액션 카드(예: "탐색하기") 클릭 → 턴 진행
4. 우측 "재화 현황" 패널의 "거래 장부" 섹션 확인

**기대 결과**:
- 거래 장부 제목: "거래 장부"
- 항목 사유: "턴 진행 비용" (한국어)

**확인 포인트**:
- ✅ "거래 장부" 제목이 한국어로 표시됨
- ✅ "T1 턴 진행 비용 -N F" 형태로 한국어 사유 표시
- ✅ 영어 텍스트가 없음

---

### 시나리오 C: 언어 전환 시 이전 세션 ledger 초기화 확인

**목적**: 언어 전환(세션 리셋) 후 이전 세션의 거래 장부 로그가 남지 않는지 검증

**실행 순서**:

1. **Step 1**: ko-KR 모드에서 턴 2~3회 진행
   - 거래 장부에 "턴 진행 비용" 항목 2~3개 생성 확인

2. **Step 2**: "프로필 변경" 버튼 클릭 → 프로필 선택 화면으로 이동

3. **Step 3**: 언어 전환 버튼 클릭 → en-US로 전환

4. **Step 4**: 프로필 선택 후 게임 시작
   - 거래 장부가 "[ NO HISTORY ]"로 비어있는지 확인

**확인 포인트**:
- ✅ 이전 한국어 세션의 "턴 진행 비용" 항목이 남아있지 않음
- ✅ 거래 장부가 빈 상태("[ NO HISTORY ]")에서 시작

---

### 시나리오 D: 하단 여백 과다 해소 확인

**목적**: 거래 장부 내용이 적을 때 하단에 과도한 빈 여백이 표시되지 않는지 검증

**실행**:
1. 프로필 선택 후 게임 시작 (항목 0개 상태)
2. 우측 "ECONOMY STATUS" / "재화 현황" 패널의 RESOURCE LOG / 거래 장부 영역 확인
3. 턴 1회 진행 (항목 1개 상태)
4. 거래 장부 영역의 높이가 내용에 맞게 콤팩트한지 확인

**기대 결과**:
- 항목 0개: "[ 이력 없음 ]" / "[ NO HISTORY ]" 텍스트만 표시, 빈 공간 최소
- 항목 1~3개: 항목 리스트가 표시되고 하단에 불필요한 빈 공간이 없음

**확인 포인트**:
- ✅ 항목 0개일 때 거래 장부 영역이 내용 크기에 맞게 축소됨
- ✅ 기존 대비 하단 빈 여백이 크게 줄어듦

---

### 시나리오 E: 항목 다수(10개 이상) 스크롤 확인

**목적**: 항목이 많을 때 카드 내부 스크롤이 정상 동작하는지 검증

**실행**:
1. 턴 5회 이상 진행 (ledger-list의 max-height: 120px 초과 시점)
2. 거래 장부 영역에 스크롤바가 나타나는지 확인
3. 최신 항목이 보이도록 자동 스크롤되는지 확인

**확인 포인트**:
- ✅ 항목이 max-height를 초과하면 내부 스크롤 활성화
- ✅ 최신 항목(가장 아래)이 자동으로 스크롤되어 보임

---

## 4. 실행 결과 확인

### 4.1 성공/실패 판단 기준

**성공**:
- ✅ en-US 모드: 거래 장부의 모든 항목이 영어로 표시 (한국어 혼합 없음)
- ✅ ko-KR 모드: 거래 장부의 모든 항목이 한국어로 표시
- ✅ 언어 전환 후 이전 세션의 거래 장부 로그가 초기화됨
- ✅ 항목 0~3개일 때 하단 빈 여백이 과도하지 않음
- ✅ 항목 5개 이상일 때 카드 내부 스크롤 정상 동작

**실패 시 확인**:
- ❌ 거래 장부에 한국어/영어가 섞여 표시됨 → `worldStore.ts`의 `addLedgerEntry` 호출부 확인
- ❌ 하단 빈 여백이 여전히 과도함 → `style.css`의 `.economy-ledger` 및 `.economy-hud-full` CSS 확인
- ❌ 스크롤이 동작하지 않음 → `.ledger-list`의 `max-height`/`overflow-y` 확인

---

## 5. 문제 해결 (Troubleshooting)

### 5.1 일반적인 오류

**오류**: 포트 8001 이미 사용 중

- **원인**: 이전 개발 서버가 종료되지 않음
- **해결**: `pnpm kill` 실행 후 다시 시작

**오류**: 거래 장부 사유가 "economy.ledger_reason.turn_cost"로 표시됨 (번역 키 그대로)

- **원인**: i18n 리소스 파일이 업데이트되지 않음
- **해결**: `translation.json` 파일에 `economy.ledger_reason.turn_cost` 키가 있는지 확인

---

## 6. 다음 단계

이 유닛은 CP-MVP-03(10분 데모 루프)에서 "영문 모드 거래 장부 정합성" 검증 항목으로 이어집니다.
