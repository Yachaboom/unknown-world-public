# CP-MVP-02 체크포인트: 클릭+드래그 데모 실행 가이드

## 1. 개요

핵심 조작 2종(핫스팟 클릭, 인벤토리 드래그&드롭)과 Action Deck 클릭이 "게임처럼" 동작하는지 수동 검증합니다.

**예상 소요 시간**: 10~15분

**의존성**:
- 의존 유닛: RU-003[Mvp], U-009[Mvp], U-010[Mvp], U-012[Mvp]
- 선행 완료 필요: 해당 유닛들의 구현 완료

---

## 2. 빠른 시작 (Quick Start)

### 2.1 환경 준비

```bash
# 프로젝트 루트에서
cd /d/Dev/unknown-world

# 의존성 설치 (최초 1회)
pnpm install
```

### 2.2 개발 서버 시작

```bash
# 백엔드 서버 시작 (새 터미널)
pnpm dev:back

# 프론트엔드 서버 시작 (새 터미널)
pnpm dev:front
```

### 2.3 서버 상태 확인

```bash
# 프론트엔드 확인
curl http://localhost:8001 -o /dev/null -w "%{http_code}"
# 예상 결과: 200

# 백엔드 확인
curl http://localhost:8011 -o /dev/null -w "%{http_code}"
# 예상 결과: 200
```

### 2.4 브라우저 접속

- URL: http://localhost:8001

---

## 3. 핵심 기능 시나리오

### 시나리오 A: Action Deck 카드 클릭

**목적**: 카드 클릭이 턴 실행을 트리거하는지 확인

**실행**:
1. Footer 영역의 Action Deck에서 "탐색하기" 카드를 클릭합니다.

**기대 결과**:
- Scene Canvas: "동기화 중..." 로딩 표시
- Agent Console: "처리 중" 상태 표시
- Action Deck/입력창: 모든 카드와 입력창이 비활성화됨
- 스트리밍 완료 후: Narrative Feed에 `[TURN n]...` 형태로 결과 추가

**확인 포인트**:
- ✅ 카드 클릭이 턴을 트리거함
- ✅ 스트리밍 중 UI 인터랙션이 차단됨
- ✅ 결과가 Narrative Feed에 반영됨

---

### 시나리오 B: 핫스팟 클릭

**목적**: Scene Canvas 핫스팟 클릭이 턴 실행을 트리거하는지 확인

**전제 조건**:
- Scene Canvas에 핫스팟(문/터미널)이 표시됨

**실행**:
1. Scene Canvas의 "문" 또는 "터미널" 핫스팟을 클릭합니다.

**기대 결과**:
- 핫스팟 클릭 시 턴 실행 트리거
- Narrative Feed에 결과 추가
- Agent Console에 처리 상태 표시

**확인 포인트**:
- ✅ 핫스팟에 마우스 호버 시 하이라이트/툴팁 표시
- ✅ 핫스팟 클릭이 턴을 트리거함
- ✅ 결과가 Narrative Feed에 반영됨

---

### 시나리오 C: 인벤토리→핫스팟 드래그&드롭

**목적**: 아이템 드래그&드롭이 정상 동작하고 즉시 피드백이 제공되는지 확인

**전제 조건**:
- Inventory 패널에 아이템이 존재함 (예: 키카드 A, 응급 키트)
- Scene Canvas에 핫스팟이 표시됨

**실행**:
1. Inventory에서 "키카드 A" 아이템을 마우스로 드래그합니다.
2. Scene Canvas의 "문" 핫스팟 위로 드래그합니다.
3. 핫스팟 위에서 마우스 버튼을 놓습니다 (드롭).

**기대 결과**:
- 드래그 시: 아이템 오버레이가 커서를 따라 표시됨
- 핫스팟 오버 시: 핫스팟이 하이라이트됨 (마젠타 글로우)
- 드롭 시: 즉시 피드백 메시지가 Narrative Feed에 추가됨
  - 예: "[온라인] 그곳에는 키카드 A을(를) 사용할 수 없습니다."

**확인 포인트**:
- ✅ 드래그 시 오버레이/피드백 표시
- ✅ 핫스팟 위 드래그 시 하이라이트
- ✅ 드롭 시 성공/실패 피드백이 즉시 표시됨 (무반응 금지)

---

### 시나리오 D: 드롭 실패 케이스 (비핫스팟 영역)

**목적**: 무효 영역 드롭 시 피드백이 제공되는지 확인

**실행**:
1. Inventory에서 아이템을 드래그합니다.
2. 핫스팟이 아닌 영역(예: Narrative Feed, Action Deck)에 드롭합니다.

**기대 결과**:
- Narrative Feed에 드롭 실패 메시지 추가
- 아이템이 Inventory에 유지됨

**확인 포인트**:
- ✅ 무효 드롭에 대한 즉시 피드백
- ✅ 무반응 상태 없음

---

## 4. 금지사항/인바리언트 체크

### 4.1 RULE-002: 채팅 버블 UI 금지

**확인 포인트**:
- [ ] 메신저형 채팅 버블(좌/우 정렬) 없음
- [ ] 내러티브가 "게임 로그" 형태로 표시됨 (`[TURN n]...`)
- [ ] 고정 레이아웃 상시 노출 (Scene Canvas, Action Deck, Inventory, Quest, Rule Board, Agent Console, Scanner)

### 4.2 RULE-008: 프롬프트 원문/내부 추론 노출 금지

**확인 포인트**:
- [ ] Agent Console에 프롬프트 원문 없음
- [ ] 단계 큐(Parse→Commit)와 검증 배지만 표시
- [ ] 내부 추론(Chain-of-thought) 노출 없음

### 4.3 RULE-009: 좌표 규약 (0~1000, [ymin,xmin,ymax,xmax])

**확인 포인트**:
- [ ] 핫스팟이 정확한 위치에 렌더링됨
- [ ] 핫스팟 크기가 Scene Canvas 크기에 비례함 (리사이즈 대응)

---

## 5. 문제 해결 (Troubleshooting)

### 5.1 일반적인 오류

**오류**: 서버 시작 실패 (포트 충돌)
- **원인**: 이미 8001 또는 8011 포트가 사용 중
- **해결**: `pnpm kill` 실행 후 다시 시도

**오류**: 핫스팟이 표시되지 않음
- **원인**: 데모 픽스처 로드 실패 또는 Scene 상태가 'scene'/'default'가 아님
- **해결**: 페이지 새로고침 후 재시도

**오류**: 드래그가 시작되지 않음
- **원인**: 스트리밍 중이거나 dnd-kit 센서 활성화 임계값(8px) 미달
- **해결**: 스트리밍 완료 대기 후 재시도, 충분히 드래그

### 5.2 환경별 주의사항

- **Windows**: 경로 구분자 주의 (`\` vs `/`)
- **macOS/Linux**: 특이사항 없음

---

## 6. 성공/실패 판단 기준

**성공**:
- ✅ Action Deck 카드 클릭 → 턴 실행 → 결과 반영
- ✅ 핫스팟 클릭 → 턴 실행 → 결과 반영
- ✅ 인벤토리→핫스팟 드래그&드롭 → 즉시 피드백
- ✅ 채팅 버블 UI 없음 (RULE-002)
- ✅ 프롬프트 노출 없음 (RULE-008)
- ✅ 좌표 규약 준수 (RULE-009)

**실패 시 확인**:
- ❌ 카드/핫스팟 클릭 무반응 → dnd-kit 설정 또는 이벤트 핸들러 확인
- ❌ 드롭 후 피드백 없음 → `handleDragEnd` 로직 확인
- ❌ 핫스팟 위치 오류 → `box2dToPixel` 함수 및 좌표 데이터 확인

---

## 7. 다음 단계

- U-013~U-015 확장 작업 진행 (퀘스트/룰/세이브/데모프로필)
- 실제 Gemini 오케스트레이터 연동 시 더 풍부한 턴 응답 확인
