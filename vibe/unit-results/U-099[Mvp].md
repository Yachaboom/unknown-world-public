# U-099[Mvp]: 거래 장부(Resource Log) 버그 수정 - i18n 언어 혼합 + 하단 여백 과다 개발 완료 보고서

## 메타데이터

- **작업 ID**: U-099[Mvp]
- **단계 번호**: MVP
- **작성 일시**: 2026-02-08 21:00
- **담당**: AI Agent

---

## 1. 작업 요약

거래 장부(Resource Log)의 두 가지 핵심 버그를 수정하였습니다. 영문 세션에서 한국어 텍스트가 노출되던 i18n 혼합 출력 문제를 해결하고, 항목이 적을 때 발생하는 UI 레이아웃의 과도한 하단 여백 문제를 개선하여 시각적 완성도를 높였습니다.

---

## 2. 작업 범위

- **i18n 언어 정합성 확보**: 거래 장부 항목 사유(`reason`)를 하드코딩 문자열에서 i18n 키 기반(`i18n.t()`)으로 전환
- **다국어 리소스 보강**: `translation.json`에 `ledger_reason` 관련 키 추가 (턴 진행 비용, 아이템 판매 등)
- **UI 레이아웃 최적화**: Economy HUD 내 거래 장부 영역의 CSS `flex` 속성 및 높이 전략 수정 (`flex: none` 및 패널 비율 조정)
- **세션 리셋 연동**: 언어 전환(세션 리셋) 시 거래 장부 데이터가 완전히 초기화되도록 보장

---

## 3. 생성/수정 파일

| 파일 경로 | 유형 | 목적 |
| --- | --- | --- |
| `frontend/src/components/EconomyHud.tsx` | 수정 | Ledger 항목 번역 로직(`useMemo`) 적용 및 레이아웃 조정 |
| `frontend/src/locales/ko-KR/translation.json` | 수정 | 한국어 거래 사유 키(`economy.ledger_reason.*`) 추가 |
| `frontend/src/locales/en-US/translation.json` | 수정 | 영어 거래 사유 키(`economy.ledger_reason.*`) 추가 |
| `frontend/src/style.css` | 수정 | 우측 사이드바 패널 비율 조정 (`panel-economy` 확대 및 여백 최적화) |
| `frontend/src/stores/economyStore.ts` | 확인 | `reset` 함수 및 초기 상태 일관성 확인 |

---

## 4. 구현 상세

### 4.1 핵심 설계

**i18n 번역 파이프라인**:
- `LedgerItem` 컴포넌트에서 `entry.reason`을 i18n 키로 취급하여 `t()` 함수를 거쳐 렌더링하도록 수정하였습니다.
- `"key|param"` 형식을 지원하여 동적 파라미터가 포함된 거래 사유도 언어별로 올바르게 표시될 수 있도록 설계하였습니다.
- 기존 하드코딩된 텍스트가 입력되더라도 `t()` 함수가 키를 찾지 못할 경우 입력값을 그대로 반환하므로 하위 호환성이 유지됩니다.

**레이아웃 최적화**:
- `style.css`에서 우측 사이드바의 `flex` 비율을 조정하여 `Agent Console`과 `Economy HUD` 간의 공간 분배를 최적화하였습니다.
- 거래 장부 항목이 적을 때 불필요한 빈 공간이 남지 않도록 컨테이너 속성을 조정하고, 항목이 많아질 경우에만 내부 스크롤이 활성화되도록 개선하였습니다.

### 4.2 외부 영향 분석

- **UI/UX**: 영문 모드 사용자가 갑작스럽게 한국어 메시지를 마주하는 경험을 차단하여 데모 품질을 향상시켰습니다.
- **성능**: `LedgerItem`에 `useMemo`를 적용하여 불필요한 재번역 연산을 방지하였습니다.

---

## 5. 런북(Runbook) 정보

- **파일 경로**: `vibe/unit-runbooks/U-099-resource-log-bugfix-runbook.md`
- **실행 결과**: 영문/한국어 모드 전환 시 사유 텍스트가 실시간으로 반영되며, 하단 여백이 항목 수에 따라 유연하게 조절됨을 확인하였습니다.

---

## 6. 리스크 및 주의사항

- **이전 세이브 데이터**: 기존에 서버에서 하드코딩된 한국어 `description`을 보내주던 시점의 로그가 로컬 스토리지에 남아있을 경우, 해당 로그는 번역되지 않고 기존 텍스트로 보일 수 있습니다. (세션 리셋 시 해결됨)

---

## 7. 다음 단계 안내

### 7.1 후속 작업

1. **데모 루프 검증**: 영문 모드에서의 거래 장부 정합성을 최종 10분 데모 시나리오에서 재검증

---

## 8. 자체 점검 결과

- [x] 영문 모드 "Turn Cost" 표시 확인
- [x] 한국어 모드 "턴 진행 비용" 표시 확인
- [x] 하단 빈 여백 최소화 및 스크롤 정상 동작 확인
- [x] 세션 리셋 시 장부 초기화 확인

---

_본 보고서는 AI Agent에 의해 자동 생성되었습니다._
