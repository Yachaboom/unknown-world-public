# U-022[Mvp]: Scanner 슬롯 UI + 업로드→아이템화 반영

## 메타데이터

| 항목      | 내용        |
| --------- | ----------- |
| Unit ID   | U-022[Mvp]  |
| Phase     | MVP         |
| 예상 소요 | 75분        |
| 의존성    | U-011,U-021 |
| 우선순위  | ⚡ Critical |
| **상태**  | ✅ **완료** (2026-01-31) |
| 결과 문서 | [U-022[Mvp].md](../unit-results/U-022[Mvp].md) |

## 작업 목표

Scanner 슬롯(드랍존)을 UI에 추가하고, 이미지 업로드→분석 결과를 “아이템/단서”로 인벤토리에 반영해 멀티모달 조작을 데모에서 바로 보여준다.

**배경**: PRD는 “이미지 드랍/업로드 → 아이템/단서화”를 데모 표면 핵심으로 요구한다. (PRD 6.7)

**완료 기준**:

- Scanner 슬롯이 상시 노출되고, 이미지 드롭/업로드가 동작한다.
- 업로드 진행/실패/성공 상태가 UI로 명확히 표시된다(무반응 금지).
- 분석 결과(item_candidates)가 인벤토리에 추가되고, 사용자가 다음 턴에서 드래그/사용할 수 있다.

## 영향받는 파일

**생성**:

- `frontend/src/components/ScannerSlot.tsx` - 드랍존/업로드 UI + 결과 표시
- `frontend/src/api/scanner.ts` - 업로드 API 호출 래퍼

**수정**:

- `frontend/src/App.tsx` - Scanner 슬롯 배치(고정 패널)
- `frontend/src/stores/inventoryStore.ts` - 결과 아이템 추가 로직(필요 시)
- `frontend/src/style.css` - 드랍존/상태/에러 스타일

**참조**:

- `vibe/prd.md` 6.7/8.6 - Scanner/이미지 이해 요구
- `.cursor/rules/10-frontend-game-ui.mdc` - 업로드/조작이 눈에 보이게
- `.cursor/rules/00-core-critical.mdc` - RULE-002/004/009

## 구현 흐름

### 1단계: Scanner 슬롯 UI(드랍/업로드) 구현

- 드랍존에 이미지 파일을 드롭하거나 파일 선택으로 업로드할 수 있게 한다.
- 업로드 중 상태(loading), 실패(error), 성공(success)을 명확히 표시한다.

### 2단계: 백엔드 스캐너 API 연동

- U-021의 `/api/scan` 호출로 캡션/오브젝트/아이템 후보를 받아온다.
- bbox/라벨을 UI에서 그대로 보여주되, 좌표 규약은 변환하지 않고 정규화 값으로 보존한다. (RULE-009)

### 3단계: 아이템화(인벤토리 반영) + 즉시 조작 가능하게

- 후보 아이템을 인벤토리에 추가하고, 즉시 드래그 가능한 아이템으로 표시한다(U-011).
- (선택) 사용자 확인(승인) 후 추가할지, 자동 추가할지 정책을 정한다(페어링 질문).

## 의존성 & 연결

**이전 작업에서 가져올 것**:

- **계획서**: [U-021[Mvp]](U-021[Mvp].md) - Scanner 백엔드 엔드포인트
- **계획서**: [U-011[Mvp]](U-011[Mvp].md) - Inventory(DnD) 기반

**다음 작업에 전달할 것**:

- RU-006에서 media/artifacts 저장/제한/보안 정책을 정리할 근거
- CP-MVP-03에서 “업로드 조작” 데모 케이스로 사용

## 주의사항

**기술적 고려사항**:

- (RULE-002) 업로드 결과를 채팅 메시지로만 보여주지 말고, 인벤토리/패널 변화로 “게임 시스템”임을 증명한다.
- (RULE-004) 실패 시에도 안전한 대체 결과를 표시하고, 플레이를 막지 않는다.

**잠재적 리스크**:

- 업로드 파일 크기/형식 문제로 실패가 잦을 수 있음 → 허용 포맷/제한을 UI에 명확히 안내하고, 실패 시 재시도 UX를 제공한다.

## 페어링 질문 (결정 필요)

- [x] **Q1**: Scanner 결과 아이템을 자동으로 인벤토리에 넣을까?
  - Option A: 자동 추가(데모 빠름, 오염 가능)
  - Option B: 사용자 확인 후 추가(권장: 의도 통제, UX는 1단계 추가)
  **A1**: Option B

## 참고 자료

- `vibe/prd.md` - Scanner 슬롯 요구
- `.cursor/rules/10-frontend-game-ui.mdc` - 조작/피드백 UI 원칙
- `.cursor/rules/00-core-critical.mdc` - RULE-002/004/009
